<!DOCTYPE html>
<html lang="en">
{% include 'partials/head.html' %}
<body>
    {% include 'partials/header.html' %}
    <section id="cart">
        <h2>Cart</h2>
        {% if cartItems %}
        <div class="cartRow">
            <div class="cartItems">
                {% for item in cartItems %}
                {% set sortedSizes = item.info.sizes | sort %}
                <div class="card">
                    <div class="img">
                        <a href="/product/{{ item.info.id }}">
                        <img src="{{ url_for('static', filename='img/products/'+item.id|string+'/'+item.info.img) }}" alt="">
                        </a>
                        <svg id="favorite{{ item['id'] }}" onclick="favorite('{{ item['id'] }}')"
                            class="favoriteIcon {% if item['id'] in userData['favorites'] %}favorite{% endif %}"
                            xmlns="http://www.w3.org/2000/svg" width="44" height="42" viewBox="0 0 44 42" fill="none">
                            <path
                                d="M43.3626 21C43.3626 32.598 33.8145 42 22.0362 42C10.2579 42 0.709778 32.598 0.709778 21C0.709778 9.40202 10.2579 0 22.0362 0C33.8145 0 43.3626 9.40202 43.3626 21Z"
                                fill="#E0E0E0" />
                            <path
                                d="M22.0362 34.1361L20.2692 32.5417C18.2178 30.6815 16.5218 29.0768 15.1813 27.7277C13.8408 26.3785 12.7744 25.1673 11.9823 24.0942C11.1902 23.021 10.6367 22.0347 10.3219 21.1352C10.0071 20.2358 9.84967 19.3159 9.84967 18.3756C9.84967 16.4541 10.4895 14.8494 11.7691 13.5616C13.0486 12.2738 14.643 11.6299 16.5523 11.6299C17.6084 11.6299 18.6138 11.8547 19.5684 12.3045C20.523 12.7542 21.3456 13.3879 22.0362 14.2055C22.7268 13.3879 23.5494 12.7542 24.504 12.3045C25.4586 11.8547 26.464 11.6299 27.5201 11.6299C29.4294 11.6299 31.0238 12.2738 32.3034 13.5616C33.5829 14.8494 34.2227 16.4541 34.2227 18.3756C34.2227 19.3159 34.0653 20.2358 33.7505 21.1352C33.4357 22.0347 32.8822 23.021 32.0901 24.0942C31.298 25.1673 30.2316 26.3785 28.8911 27.7277C27.5506 29.0768 25.8546 30.6815 23.8032 32.5417L22.0362 34.1361ZM22.0362 30.8246C23.986 29.0666 25.5906 27.559 26.8499 26.3019C28.1092 25.0447 29.1044 23.9511 29.8356 23.021C30.5668 22.0909 31.0745 21.263 31.3589 20.5373C31.6432 19.8116 31.7854 19.0911 31.7854 18.3756C31.7854 17.1491 31.3792 16.127 30.5668 15.3094C29.7543 14.4917 28.7388 14.0829 27.5201 14.0829C26.5655 14.0829 25.682 14.3537 24.8696 14.8954C24.0571 15.4371 23.4986 16.127 23.1939 16.9651H20.8785C20.5738 16.127 20.0153 15.4371 19.2028 14.8954C18.3904 14.3537 17.5069 14.0829 16.5523 14.0829C15.3336 14.0829 14.3181 14.4917 13.5056 15.3094C12.6932 16.127 12.287 17.1491 12.287 18.3756C12.287 19.0911 12.4292 19.8116 12.7135 20.5373C12.9979 21.263 13.5056 22.0909 14.2368 23.021C14.968 23.9511 15.9632 25.0447 17.2225 26.3019C18.4818 27.559 20.0864 29.0666 22.0362 30.8246Z"
                                fill="#111111" />
                        </svg>
                    </div>
                    <div class="data">
                        <div class="row">
                            <div class="col" id="card{{ item.id }}">
                                <h4>{{ item.info.category }} {{ item.info.brand }}</h4>
                                <p>Product number: {{ item.id }}</p>
                                <p class="infoSize">Size: {{ item.size }}</p>
                                <p class="infoQuantity">Quantity: {{ item.quantity }}</p>
                                <div style="display: none;" class="select editSize">
                                    <label for="size">Size:</label>
                                    <select class="size" id="size{{ item.id }}" name="size" onchange="selectSizeCart({{ item.id }})">
                                        {% if sortedSizes %}
                                        <option value="{{ sortedSizes[0] }}" selected>{{ sortedSizes[0] }}</option>
                                        {% endif %}
                                        {% for size in sortedSizes[1:] %}
                                        <option value="{{ size }}">{{ size }}</option>
                                        {% endfor %}
                                    </select>
                                    <svg class="downArrow" xmlns="http://www.w3.org/2000/svg" width="24" height="14" viewBox="0 0 24 14" fill="none">
                                        <path
                                            d="M0.321533 2.1104L2.36278 -9.16136e-07L11.8215 9.77919L21.2803 -8.92259e-08L23.3215 2.1104L11.8215 14L0.321533 2.1104Z"
                                            fill="#F1F1F1" />
                                    </svg>
                                </div>
                                <div style="display: none;" class="select editQuantity">
                                    <label for="quantity">Quantity:</label>
                                    <select class="quantity quantity{{ sortedSizes[0] }}" id="quantity{{ sortedSizes[0] }}{{ item.id }}" name="quantity">
                                        {% if item.info.maxQuantities %}
                                        {% for n in range(item.info.maxQuantities[sortedSizes[0] | string]) %}
                                        <option value="{{ n+1 }}">{{ n+1 }}</option>
                                        {% endfor %}
                                        {% endif %}
                                    </select>
                                    {% for size in sortedSizes[1:] %}
                                    <select class="quantity quantity{{ size }}" disabled style="display: none;" id="quantity{{ size }}{{ item.id }}" name="quantity">
                                        {% for n in range(item.info.maxQuantities[size | string]) %}
                                        <option value="{{ n+1 }}">{{ n+1 }}</option>
                                        {% endfor %}
                                    </select>
                                    {% endfor %}
                                    <svg class="downArrow" xmlns="http://www.w3.org/2000/svg" width="24" height="14" viewBox="0 0 24 14" fill="none">
                                        <path
                                            d="M0.321533 2.1104L2.36278 -9.16136e-07L11.8215 9.77919L21.2803 -8.92259e-08L23.3215 2.1104L11.8215 14L0.321533 2.1104Z"
                                            fill="#F1F1F1" />
                                    </svg>
                                </div>
                            </div>
                            <div class="col end">
                                {% if item.info.maxQuantities %}
                                    <p class="instock">In stock</p>
                                {% else %}
                                    <p class="notinstock">Not in stock</p>
                                {% endif %}
                                <p>Price: {{ item.info.price }} uah</p>
                            </div>
                        </div>
                        <div class="row">
                            <button id="buttonLeft{{ item.id }}" onclick="removeFromCart({{ item.id }}, {{ item.size }}, {{ item.quantity }})">Remove</button>
                            <button id="buttonRight{{ item.id }}" onclick="editCart({{ item.id }})">Edit</button>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <div class="summary">
                <h4>Summary</h4>
                <div class="row">
                    <p>Subtotal:</p>
                    <p>{{ subtotal }} uah</p>
                </div>
                <a href="/checkout">Checkout</a>
            </div>
        </div>
        {% else %}
        <div class="cartEmpty">
            <h4>Your cart is empty</h4>
            <a href="/shop">Visit shop</a>
        </div>
        {% endif %}
    </section>
    <section id="featured" class="product">
        {% if cartItems %}
        <h2>You might also like</h2>
        {% else %}
        <h2>Featured products</h2>
        {% endif %}
        <div class="products">
            {% for product in productsFeatured %}
            {% include 'partials/card.html' %}
            {% endfor %}
        </div>
    </section>
    {% include 'partials/newsletter.html' %}
    {% include 'partials/footer.html' %}
    <script src="{{ url_for('static', filename='js/shop.js') }}"></script>
</body>
</html>